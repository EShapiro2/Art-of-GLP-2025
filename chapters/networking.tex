% chapters/networking.tex - Grassroots Social Networking

\chapter{Grassroots Social Networking}
\label{ch:networking}

This chapter presents grassroots social networking applications built on the social graph. We begin with channels---a generalization of streams that supports multiple concurrent writers---which is essential for multi-party communication.

\section{Channels: Generalized Streams}
\label{sec:channels}

Streams are \emph{totally ordered}---messages have a definite sequence. \emph{Channels} generalize streams to \emph{partially ordered} sets of messages, where multiple writers need not synchronize.

\subsection{Multistream Representation}

A channel is represented as a ``multistream''---either a regular list or a branch:
\begin{verbatim}
%% Regular stream element
[Message | Rest]

%% Branch: two concurrent subchannels
branch(Left, Right)
\end{verbatim}

Multiple writers can write to different branches concurrently without coordination.

\subsection{Channel Operations}

\begin{verbatim}
%% Read: nondeterministically reads a minimal element
read(Message, [Message|Channel?], Channel).
read(Message, branch(Left1, Right?), branch(Left2, Right)) :-
    read(Message?, Left1?, Left2).
read(Message, branch(Left?, Right1), branch(Left, Right2)) :-
    read(Message?, Right1?, Right2).

%% Write: creates or extends a branch
write(Message, Channel, Left) :-
    Channel = branch([Message|Left?], _) | true.
write(Message, Channel, Out) :-
    Channel? = branch(_, Right?) |
    write(Message?, Right?, Out).

%% Empty test
empty([]).
empty(branch(Left, Right)) :-
    empty(Left?), empty(Right?) | true.
\end{verbatim}

The \verb|read| operation nondeterministically selects a minimal element from any branch. The \verb|write| operation creates a new branch or extends an existing one.

\subsection{Serializing Channels}

To convert a channel back to a totally-ordered stream:

\begin{verbatim}
serialize(Channel, [Message|Stream?]) :-
    min(Message?, Channel?, Channel2) |
    serialize(Channel2?, Stream).
serialize(Channel, Stream) :-
    branches(Channel?, C1, C2) |
    serialize(C1?, S1),
    serialize(C2?, S2),
    merge(S1?, S2?, Stream).
serialize(Channel, []) :-
    empty(Channel?) | true.
\end{verbatim}

Serialization recursively merges the branches, producing a deterministic stream from the partial order.

\section{Message Passing}

\section{Group Communication}

\section{Content Sharing}

\section{Privacy and Encryption}

\section{Exercises}

[To be developed]
